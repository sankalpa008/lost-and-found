{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/sankalpadhungana/Desktop/Sankalpa/lost-and-found/app/actions/auth.ts"],"sourcesContent":["\"use server\";\n\nimport prisma from \"@/lib/prisma\";\nimport { hashPassword, verifyPassword, createSession, setSessionCookie, clearSessionCookie, deleteSession } from \"@/lib/auth\";\nimport { revalidatePath } from \"next/cache\";\nimport { redirect } from \"next/navigation\";\nimport { cookies } from \"next/headers\";\n\nexport async function signUp(email: string, password: string, name?: string) {\n  try {\n    // Check if user already exists\n    const existing = await prisma.user.findUnique({ where: { email } });\n    if (existing) {\n      return { success: false, error: \"Email already in use\" };\n    }\n\n    // Hash password and create user\n    const hashedPassword = await hashPassword(password);\n    const user = await prisma.user.create({\n      data: {\n        email,\n        password: hashedPassword,\n        name,\n        role: \"STUDENT\",\n      },\n    });\n\n    // Create session\n    const token = await createSession(user.id);\n    await setSessionCookie(token);\n\n    return { success: true, user: { id: user.id, email: user.email, name: user.name } };\n  } catch (error) {\n    console.error(\"Signup error:\", error);\n    return { success: false, error: \"Failed to create account\" };\n  }\n}\n\nexport async function signIn(email: string, password: string) {\n  try {\n    // Find user\n    const user = await prisma.user.findUnique({ where: { email } });\n    if (!user) {\n      return { success: false, error: \"Invalid email or password\" };\n    }\n\n    // Verify password\n    const valid = await verifyPassword(password, user.password);\n    if (!valid) {\n      return { success: false, error: \"Invalid email or password\" };\n    }\n\n    // Create session\n    const token = await createSession(user.id);\n    await setSessionCookie(token);\n\n    return { success: true, user: { id: user.id, email: user.email, name: user.name } };\n  } catch (error) {\n    console.error(\"Signin error:\", error);\n    return { success: false, error: \"Failed to sign in\" };\n  }\n}\n\nexport async function signOut() {\n  try {\n    const cookieStore = await cookies();\n    const token = cookieStore.get(\"session\")?.value;\n\n    if (token) {\n      await deleteSession(token);\n    }\n\n    await clearSessionCookie();\n    revalidatePath(\"/\");\n  } catch (error) {\n    console.error(\"Signout error:\", error);\n  }\n\n  redirect(\"/login\");\n}\n"],"names":[],"mappings":";;;;;;;IA+DsB,UAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA"}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/sankalpadhungana/Desktop/Sankalpa/lost-and-found/components/Navbar.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport { usePathname } from \"next/navigation\";\nimport { signOut } from \"@/app/actions/auth\";\nimport { Home, LayoutDashboard, LogOut, Shield } from \"lucide-react\";\n\ninterface NavbarProps {\n  user?: {\n    name: string | null;\n    email: string;\n    role: string;\n  } | null;\n}\n\nexport default function Navbar({ user }: NavbarProps) {\n  const pathname = usePathname();\n\n  const handleSignOut = async () => {\n    await signOut();\n  };\n\n  return (\n    <nav className=\"bg-white shadow-md\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"flex justify-between h-16\">\n          <div className=\"flex items-center\">\n            <Link href=\"/\" className=\"flex items-center gap-2\">\n              <span className=\"text-xl font-bold text-blue-600\">University Lost & Found</span>\n            </Link>\n\n            <div className=\"ml-10 flex items-center gap-4\">\n              <Link href=\"/\" className={`flex items-center gap-1 px-3 py-2 rounded-md text-sm font-medium ${pathname === \"/\" ? \"bg-blue-100 text-blue-700\" : \"text-gray-700 hover:bg-gray-100\"}`}>\n                <Home className=\"w-4 h-4\" />\n                Home\n              </Link>\n\n              {user && (\n                <Link href=\"/dashboard\" className={`flex items-center gap-1 px-3 py-2 rounded-md text-sm font-medium ${pathname === \"/dashboard\" ? \"bg-blue-100 text-blue-700\" : \"text-gray-700 hover:bg-gray-100\"}`}>\n                  <LayoutDashboard className=\"w-4 h-4\" />\n                  Dashboard\n                </Link>\n              )}\n\n              {user?.role === \"ADMIN\" && (\n                <Link href=\"/admin\" className={`flex items-center gap-1 px-3 py-2 rounded-md text-sm font-medium ${pathname === \"/admin\" ? \"bg-blue-100 text-blue-700\" : \"text-gray-700 hover:bg-gray-100\"}`}>\n                  <Shield className=\"w-4 h-4\" />\n                  Admin\n                </Link>\n              )}\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-4\">\n            {user ? (\n              <>\n                <div className=\"text-sm\">\n                  <p className=\"font-medium text-gray-700\">{user.name || \"User\"}</p>\n                  <p className=\"text-xs text-gray-500\">{user.role}</p>\n                </div>\n                <button onClick={handleSignOut} className=\"flex items-center gap-1 px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100\">\n                  <LogOut className=\"w-4 h-4\" />\n                  Sign Out\n                </button>\n              </>\n            ) : (\n              <Link href=\"/login\" className=\"px-4 py-2 rounded-md text-sm font-medium text-white bg-blue-600 hover:bg-blue-700\">\n                Sign In\n              </Link>\n            )}\n          </div>\n        </div>\n      </div>\n    </nav>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AALA;;;;;;AAee,SAAS,OAAO,EAAE,IAAI,EAAe;IAClD,MAAM,WAAW,IAAA,iJAAW;IAE5B,MAAM,gBAAgB;QACpB,MAAM,IAAA,iKAAO;IACf;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC,uKAAI;gCAAC,MAAK;gCAAI,WAAU;0CACvB,cAAA,8OAAC;oCAAK,WAAU;8CAAkC;;;;;;;;;;;0CAGpD,8OAAC;gCAAI,WAAU;;kDACb,8OAAC,uKAAI;wCAAC,MAAK;wCAAI,WAAW,CAAC,iEAAiE,EAAE,aAAa,MAAM,8BAA8B,mCAAmC;;0DAChL,8OAAC,2MAAI;gDAAC,WAAU;;;;;;4CAAY;;;;;;;oCAI7B,sBACC,8OAAC,uKAAI;wCAAC,MAAK;wCAAa,WAAW,CAAC,iEAAiE,EAAE,aAAa,eAAe,8BAA8B,mCAAmC;;0DAClM,8OAAC,+OAAe;gDAAC,WAAU;;;;;;4CAAY;;;;;;;oCAK1C,MAAM,SAAS,yBACd,8OAAC,uKAAI;wCAAC,MAAK;wCAAS,WAAW,CAAC,iEAAiE,EAAE,aAAa,WAAW,8BAA8B,mCAAmC;;0DAC1L,8OAAC,gNAAM;gDAAC,WAAU;;;;;;4CAAY;;;;;;;;;;;;;;;;;;;kCAOtC,8OAAC;wBAAI,WAAU;kCACZ,qBACC;;8CACE,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAE,WAAU;sDAA6B,KAAK,IAAI,IAAI;;;;;;sDACvD,8OAAC;4CAAE,WAAU;sDAAyB,KAAK,IAAI;;;;;;;;;;;;8CAEjD,8OAAC;oCAAO,SAAS;oCAAe,WAAU;;sDACxC,8OAAC,oNAAM;4CAAC,WAAU;;;;;;wCAAY;;;;;;;;yDAKlC,8OAAC,uKAAI;4BAAC,MAAK;4BAAS,WAAU;sCAAoF;;;;;;;;;;;;;;;;;;;;;;;;;;;AAShI"}},
    {"offset": {"line": 241, "column": 0}, "map": {"version":3,"sources":["file:///Users/sankalpadhungana/Desktop/Sankalpa/lost-and-found/app/actions/items.ts"],"sourcesContent":["\"use server\";\n\nimport prisma from \"@/lib/prisma\";\nimport { requireAuth } from \"@/lib/auth\";\nimport { revalidatePath } from \"next/cache\";\nimport { Category, ItemStatus } from \"@prisma/client\";\nimport { uploadImage, deleteImage } from \"@/lib/storage\";\n\nexport async function uploadItemImage(formData: FormData) {\n  try {\n    const file = formData.get(\"file\") as File;\n    if (!file) {\n      return { success: false, error: \"No file provided\" };\n    }\n\n    const imageUrl = await uploadImage(file);\n    return { success: true, imageUrl };\n  } catch (error) {\n    console.error(\"Error uploading image:\", error);\n    return { success: false, error: \"Failed to upload image\" };\n  }\n}\n\nexport async function createItem(formData: FormData) {\n  const user = await requireAuth();\n\n  const title = formData.get(\"title\") as string;\n  const description = formData.get(\"description\") as string;\n  const category = formData.get(\"category\") as Category;\n  const location = formData.get(\"location\") as string;\n  const contactNumber = formData.get(\"contactNumber\") as string;\n  const status = formData.get(\"status\") as ItemStatus;\n  const imageUrl = formData.get(\"imageUrl\") as string;\n\n  try {\n    const item = await prisma.item.create({\n      data: {\n        title,\n        description,\n        category,\n        location,\n        contactNumber,\n        status,\n        imageUrl,\n        userId: user.id,\n      },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    return { success: true, item };\n  } catch (error) {\n    console.error(\"Error creating item:\", error);\n    return { success: false, error: \"Failed to create item\" };\n  }\n}\n\nexport async function updateItem(itemId: string, formData: FormData) {\n  const user = await requireAuth();\n\n  const item = await prisma.item.findUnique({\n    where: { id: itemId },\n  });\n\n  if (!item) {\n    return { success: false, error: \"Item not found\" };\n  }\n\n  // Check if user owns the item or is admin\n  if (item.userId !== user.id && user.role !== \"ADMIN\") {\n    return { success: false, error: \"Unauthorized\" };\n  }\n\n  const title = formData.get(\"title\") as string;\n  const description = formData.get(\"description\") as string;\n  const category = formData.get(\"category\") as Category;\n  const location = formData.get(\"location\") as string;\n  const contactNumber = formData.get(\"contactNumber\") as string;\n  const status = formData.get(\"status\") as ItemStatus;\n  const imageUrl = formData.get(\"imageUrl\") as string | null;\n\n  try {\n    const updatedItem = await prisma.item.update({\n      where: { id: itemId },\n      data: {\n        title,\n        description,\n        category,\n        location,\n        contactNumber,\n        status,\n        ...(imageUrl && { imageUrl }),\n      },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    revalidatePath(`/items/${itemId}`);\n    return { success: true, item: updatedItem };\n  } catch (error) {\n    console.error(\"Error updating item:\", error);\n    return { success: false, error: \"Failed to update item\" };\n  }\n}\n\nexport async function deleteItem(itemId: string) {\n  const user = await requireAuth();\n\n  const item = await prisma.item.findUnique({\n    where: { id: itemId },\n  });\n\n  if (!item) {\n    return { success: false, error: \"Item not found\" };\n  }\n\n  // Check if user owns the item or is admin\n  if (item.userId !== user.id && user.role !== \"ADMIN\") {\n    return { success: false, error: \"Unauthorized\" };\n  }\n\n  try {\n    // Delete image if exists\n    if (item.imageUrl) {\n      await deleteImage(item.imageUrl);\n    }\n\n    await prisma.item.delete({\n      where: { id: itemId },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    return { success: true };\n  } catch (error) {\n    console.error(\"Error deleting item:\", error);\n    return { success: false, error: \"Failed to delete item\" };\n  }\n}\n\nexport async function markItemAsResolved(itemId: string, resolved: boolean) {\n  const user = await requireAuth();\n\n  const item = await prisma.item.findUnique({\n    where: { id: itemId },\n  });\n\n  if (!item) {\n    return { success: false, error: \"Item not found\" };\n  }\n\n  // Check if user owns the item or is admin\n  if (item.userId !== user.id && user.role !== \"ADMIN\") {\n    return { success: false, error: \"Unauthorized\" };\n  }\n\n  try {\n    const updatedItem = await prisma.item.update({\n      where: { id: itemId },\n      data: { isResolved: resolved },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    revalidatePath(`/items/${itemId}`);\n    return { success: true, item: updatedItem };\n  } catch (error) {\n    console.error(\"Error updating item:\", error);\n    return { success: false, error: \"Failed to update item\" };\n  }\n}\n\nexport async function getItems(filters?: { search?: string; category?: Category; status?: ItemStatus; resolved?: boolean }) {\n  try {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const where: any = {};\n\n    if (filters?.search) {\n      where.OR = [{ title: { contains: filters.search, mode: \"insensitive\" } }, { description: { contains: filters.search, mode: \"insensitive\" } }, { location: { contains: filters.search, mode: \"insensitive\" } }];\n    }\n\n    if (filters?.category) {\n      where.category = filters.category;\n    }\n\n    if (filters?.status) {\n      where.status = filters.status;\n    }\n\n    if (filters?.resolved !== undefined) {\n      where.isResolved = filters.resolved;\n    }\n\n    const items = await prisma.item.findMany({\n      where,\n      include: {\n        user: {\n          select: {\n            name: true,\n            email: true,\n          },\n        },\n      },\n      orderBy: {\n        createdAt: \"desc\",\n      },\n    });\n\n    return items;\n  } catch (error) {\n    console.error(\"Error fetching items:\", error);\n    return [];\n  }\n}\n\nexport async function getItemById(itemId: string) {\n  try {\n    const item = await prisma.item.findUnique({\n      where: { id: itemId },\n      include: {\n        user: {\n          select: {\n            name: true,\n            email: true,\n          },\n        },\n      },\n    });\n\n    return item;\n  } catch (error) {\n    console.error(\"Error fetching item:\", error);\n    return null;\n  }\n}\n\nexport async function getUserItems() {\n  const user = await requireAuth();\n\n  try {\n    const items = await prisma.item.findMany({\n      where: { userId: user.id },\n      orderBy: { createdAt: \"desc\" },\n    });\n\n    return items;\n  } catch (error) {\n    console.error(\"Error fetching user items:\", error);\n    return [];\n  }\n}\n"],"names":[],"mappings":";;;;;;;IAuBsB,aAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA"}},
    {"offset": {"line": 253, "column": 0}, "map": {"version":3,"sources":["file:///Users/sankalpadhungana/Desktop/Sankalpa/lost-and-found/app/actions/items.ts"],"sourcesContent":["\"use server\";\n\nimport prisma from \"@/lib/prisma\";\nimport { requireAuth } from \"@/lib/auth\";\nimport { revalidatePath } from \"next/cache\";\nimport { Category, ItemStatus } from \"@prisma/client\";\nimport { uploadImage, deleteImage } from \"@/lib/storage\";\n\nexport async function uploadItemImage(formData: FormData) {\n  try {\n    const file = formData.get(\"file\") as File;\n    if (!file) {\n      return { success: false, error: \"No file provided\" };\n    }\n\n    const imageUrl = await uploadImage(file);\n    return { success: true, imageUrl };\n  } catch (error) {\n    console.error(\"Error uploading image:\", error);\n    return { success: false, error: \"Failed to upload image\" };\n  }\n}\n\nexport async function createItem(formData: FormData) {\n  const user = await requireAuth();\n\n  const title = formData.get(\"title\") as string;\n  const description = formData.get(\"description\") as string;\n  const category = formData.get(\"category\") as Category;\n  const location = formData.get(\"location\") as string;\n  const contactNumber = formData.get(\"contactNumber\") as string;\n  const status = formData.get(\"status\") as ItemStatus;\n  const imageUrl = formData.get(\"imageUrl\") as string;\n\n  try {\n    const item = await prisma.item.create({\n      data: {\n        title,\n        description,\n        category,\n        location,\n        contactNumber,\n        status,\n        imageUrl,\n        userId: user.id,\n      },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    return { success: true, item };\n  } catch (error) {\n    console.error(\"Error creating item:\", error);\n    return { success: false, error: \"Failed to create item\" };\n  }\n}\n\nexport async function updateItem(itemId: string, formData: FormData) {\n  const user = await requireAuth();\n\n  const item = await prisma.item.findUnique({\n    where: { id: itemId },\n  });\n\n  if (!item) {\n    return { success: false, error: \"Item not found\" };\n  }\n\n  // Check if user owns the item or is admin\n  if (item.userId !== user.id && user.role !== \"ADMIN\") {\n    return { success: false, error: \"Unauthorized\" };\n  }\n\n  const title = formData.get(\"title\") as string;\n  const description = formData.get(\"description\") as string;\n  const category = formData.get(\"category\") as Category;\n  const location = formData.get(\"location\") as string;\n  const contactNumber = formData.get(\"contactNumber\") as string;\n  const status = formData.get(\"status\") as ItemStatus;\n  const imageUrl = formData.get(\"imageUrl\") as string | null;\n\n  try {\n    const updatedItem = await prisma.item.update({\n      where: { id: itemId },\n      data: {\n        title,\n        description,\n        category,\n        location,\n        contactNumber,\n        status,\n        ...(imageUrl && { imageUrl }),\n      },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    revalidatePath(`/items/${itemId}`);\n    return { success: true, item: updatedItem };\n  } catch (error) {\n    console.error(\"Error updating item:\", error);\n    return { success: false, error: \"Failed to update item\" };\n  }\n}\n\nexport async function deleteItem(itemId: string) {\n  const user = await requireAuth();\n\n  const item = await prisma.item.findUnique({\n    where: { id: itemId },\n  });\n\n  if (!item) {\n    return { success: false, error: \"Item not found\" };\n  }\n\n  // Check if user owns the item or is admin\n  if (item.userId !== user.id && user.role !== \"ADMIN\") {\n    return { success: false, error: \"Unauthorized\" };\n  }\n\n  try {\n    // Delete image if exists\n    if (item.imageUrl) {\n      await deleteImage(item.imageUrl);\n    }\n\n    await prisma.item.delete({\n      where: { id: itemId },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    return { success: true };\n  } catch (error) {\n    console.error(\"Error deleting item:\", error);\n    return { success: false, error: \"Failed to delete item\" };\n  }\n}\n\nexport async function markItemAsResolved(itemId: string, resolved: boolean) {\n  const user = await requireAuth();\n\n  const item = await prisma.item.findUnique({\n    where: { id: itemId },\n  });\n\n  if (!item) {\n    return { success: false, error: \"Item not found\" };\n  }\n\n  // Check if user owns the item or is admin\n  if (item.userId !== user.id && user.role !== \"ADMIN\") {\n    return { success: false, error: \"Unauthorized\" };\n  }\n\n  try {\n    const updatedItem = await prisma.item.update({\n      where: { id: itemId },\n      data: { isResolved: resolved },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    revalidatePath(`/items/${itemId}`);\n    return { success: true, item: updatedItem };\n  } catch (error) {\n    console.error(\"Error updating item:\", error);\n    return { success: false, error: \"Failed to update item\" };\n  }\n}\n\nexport async function getItems(filters?: { search?: string; category?: Category; status?: ItemStatus; resolved?: boolean }) {\n  try {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const where: any = {};\n\n    if (filters?.search) {\n      where.OR = [{ title: { contains: filters.search, mode: \"insensitive\" } }, { description: { contains: filters.search, mode: \"insensitive\" } }, { location: { contains: filters.search, mode: \"insensitive\" } }];\n    }\n\n    if (filters?.category) {\n      where.category = filters.category;\n    }\n\n    if (filters?.status) {\n      where.status = filters.status;\n    }\n\n    if (filters?.resolved !== undefined) {\n      where.isResolved = filters.resolved;\n    }\n\n    const items = await prisma.item.findMany({\n      where,\n      include: {\n        user: {\n          select: {\n            name: true,\n            email: true,\n          },\n        },\n      },\n      orderBy: {\n        createdAt: \"desc\",\n      },\n    });\n\n    return items;\n  } catch (error) {\n    console.error(\"Error fetching items:\", error);\n    return [];\n  }\n}\n\nexport async function getItemById(itemId: string) {\n  try {\n    const item = await prisma.item.findUnique({\n      where: { id: itemId },\n      include: {\n        user: {\n          select: {\n            name: true,\n            email: true,\n          },\n        },\n      },\n    });\n\n    return item;\n  } catch (error) {\n    console.error(\"Error fetching item:\", error);\n    return null;\n  }\n}\n\nexport async function getUserItems() {\n  const user = await requireAuth();\n\n  try {\n    const items = await prisma.item.findMany({\n      where: { userId: user.id },\n      orderBy: { createdAt: \"desc\" },\n    });\n\n    return items;\n  } catch (error) {\n    console.error(\"Error fetching user items:\", error);\n    return [];\n  }\n}\n"],"names":[],"mappings":";;;;;;;IAyDsB,aAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA"}},
    {"offset": {"line": 265, "column": 0}, "map": {"version":3,"sources":["file:///Users/sankalpadhungana/Desktop/Sankalpa/lost-and-found/app/actions/items.ts"],"sourcesContent":["\"use server\";\n\nimport prisma from \"@/lib/prisma\";\nimport { requireAuth } from \"@/lib/auth\";\nimport { revalidatePath } from \"next/cache\";\nimport { Category, ItemStatus } from \"@prisma/client\";\nimport { uploadImage, deleteImage } from \"@/lib/storage\";\n\nexport async function uploadItemImage(formData: FormData) {\n  try {\n    const file = formData.get(\"file\") as File;\n    if (!file) {\n      return { success: false, error: \"No file provided\" };\n    }\n\n    const imageUrl = await uploadImage(file);\n    return { success: true, imageUrl };\n  } catch (error) {\n    console.error(\"Error uploading image:\", error);\n    return { success: false, error: \"Failed to upload image\" };\n  }\n}\n\nexport async function createItem(formData: FormData) {\n  const user = await requireAuth();\n\n  const title = formData.get(\"title\") as string;\n  const description = formData.get(\"description\") as string;\n  const category = formData.get(\"category\") as Category;\n  const location = formData.get(\"location\") as string;\n  const contactNumber = formData.get(\"contactNumber\") as string;\n  const status = formData.get(\"status\") as ItemStatus;\n  const imageUrl = formData.get(\"imageUrl\") as string;\n\n  try {\n    const item = await prisma.item.create({\n      data: {\n        title,\n        description,\n        category,\n        location,\n        contactNumber,\n        status,\n        imageUrl,\n        userId: user.id,\n      },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    return { success: true, item };\n  } catch (error) {\n    console.error(\"Error creating item:\", error);\n    return { success: false, error: \"Failed to create item\" };\n  }\n}\n\nexport async function updateItem(itemId: string, formData: FormData) {\n  const user = await requireAuth();\n\n  const item = await prisma.item.findUnique({\n    where: { id: itemId },\n  });\n\n  if (!item) {\n    return { success: false, error: \"Item not found\" };\n  }\n\n  // Check if user owns the item or is admin\n  if (item.userId !== user.id && user.role !== \"ADMIN\") {\n    return { success: false, error: \"Unauthorized\" };\n  }\n\n  const title = formData.get(\"title\") as string;\n  const description = formData.get(\"description\") as string;\n  const category = formData.get(\"category\") as Category;\n  const location = formData.get(\"location\") as string;\n  const contactNumber = formData.get(\"contactNumber\") as string;\n  const status = formData.get(\"status\") as ItemStatus;\n  const imageUrl = formData.get(\"imageUrl\") as string | null;\n\n  try {\n    const updatedItem = await prisma.item.update({\n      where: { id: itemId },\n      data: {\n        title,\n        description,\n        category,\n        location,\n        contactNumber,\n        status,\n        ...(imageUrl && { imageUrl }),\n      },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    revalidatePath(`/items/${itemId}`);\n    return { success: true, item: updatedItem };\n  } catch (error) {\n    console.error(\"Error updating item:\", error);\n    return { success: false, error: \"Failed to update item\" };\n  }\n}\n\nexport async function deleteItem(itemId: string) {\n  const user = await requireAuth();\n\n  const item = await prisma.item.findUnique({\n    where: { id: itemId },\n  });\n\n  if (!item) {\n    return { success: false, error: \"Item not found\" };\n  }\n\n  // Check if user owns the item or is admin\n  if (item.userId !== user.id && user.role !== \"ADMIN\") {\n    return { success: false, error: \"Unauthorized\" };\n  }\n\n  try {\n    // Delete image if exists\n    if (item.imageUrl) {\n      await deleteImage(item.imageUrl);\n    }\n\n    await prisma.item.delete({\n      where: { id: itemId },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    return { success: true };\n  } catch (error) {\n    console.error(\"Error deleting item:\", error);\n    return { success: false, error: \"Failed to delete item\" };\n  }\n}\n\nexport async function markItemAsResolved(itemId: string, resolved: boolean) {\n  const user = await requireAuth();\n\n  const item = await prisma.item.findUnique({\n    where: { id: itemId },\n  });\n\n  if (!item) {\n    return { success: false, error: \"Item not found\" };\n  }\n\n  // Check if user owns the item or is admin\n  if (item.userId !== user.id && user.role !== \"ADMIN\") {\n    return { success: false, error: \"Unauthorized\" };\n  }\n\n  try {\n    const updatedItem = await prisma.item.update({\n      where: { id: itemId },\n      data: { isResolved: resolved },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    revalidatePath(`/items/${itemId}`);\n    return { success: true, item: updatedItem };\n  } catch (error) {\n    console.error(\"Error updating item:\", error);\n    return { success: false, error: \"Failed to update item\" };\n  }\n}\n\nexport async function getItems(filters?: { search?: string; category?: Category; status?: ItemStatus; resolved?: boolean }) {\n  try {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const where: any = {};\n\n    if (filters?.search) {\n      where.OR = [{ title: { contains: filters.search, mode: \"insensitive\" } }, { description: { contains: filters.search, mode: \"insensitive\" } }, { location: { contains: filters.search, mode: \"insensitive\" } }];\n    }\n\n    if (filters?.category) {\n      where.category = filters.category;\n    }\n\n    if (filters?.status) {\n      where.status = filters.status;\n    }\n\n    if (filters?.resolved !== undefined) {\n      where.isResolved = filters.resolved;\n    }\n\n    const items = await prisma.item.findMany({\n      where,\n      include: {\n        user: {\n          select: {\n            name: true,\n            email: true,\n          },\n        },\n      },\n      orderBy: {\n        createdAt: \"desc\",\n      },\n    });\n\n    return items;\n  } catch (error) {\n    console.error(\"Error fetching items:\", error);\n    return [];\n  }\n}\n\nexport async function getItemById(itemId: string) {\n  try {\n    const item = await prisma.item.findUnique({\n      where: { id: itemId },\n      include: {\n        user: {\n          select: {\n            name: true,\n            email: true,\n          },\n        },\n      },\n    });\n\n    return item;\n  } catch (error) {\n    console.error(\"Error fetching item:\", error);\n    return null;\n  }\n}\n\nexport async function getUserItems() {\n  const user = await requireAuth();\n\n  try {\n    const items = await prisma.item.findMany({\n      where: { userId: user.id },\n      orderBy: { createdAt: \"desc\" },\n    });\n\n    return items;\n  } catch (error) {\n    console.error(\"Error fetching user items:\", error);\n    return [];\n  }\n}\n"],"names":[],"mappings":";;;;;;;IAQsB,kBAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA"}},
    {"offset": {"line": 277, "column": 0}, "map": {"version":3,"sources":["file:///Users/sankalpadhungana/Desktop/Sankalpa/lost-and-found/components/ItemForm.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { createItem, updateItem, uploadItemImage } from \"@/app/actions/items\";\nimport { useRouter } from \"next/navigation\";\n\nconst CATEGORIES = [\"ELECTRONICS\", \"BOOKS\", \"CLOTHING\", \"ACCESSORIES\", \"DOCUMENTS\", \"KEYS\", \"BAGS\", \"SPORTS\", \"OTHER\"];\n\ninterface ItemFormProps {\n  mode?: \"create\" | \"edit\";\n  initialData?: {\n    id: string;\n    title: string;\n    description: string;\n    category: string;\n    location: string;\n    contactNumber: string;\n    status: string;\n    imageUrl?: string | null;\n  };\n  onSuccess?: () => void;\n}\n\nexport default function ItemForm({ mode = \"create\", initialData, onSuccess }: ItemFormProps) {\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [imageFile, setImageFile] = useState<File | null>(null);\n  const [imagePreview, setImagePreview] = useState<string | null>(initialData?.imageUrl || null);\n  const router = useRouter();\n\n  const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      setImageFile(file);\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setImagePreview(reader.result as string);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    setLoading(true);\n    setError(null);\n\n    try {\n      const formData = new FormData(e.currentTarget);\n\n      // Upload image if a new one is selected\n      if (imageFile) {\n        const uploadFormData = new FormData();\n        uploadFormData.append(\"file\", imageFile);\n        const uploadResult = await uploadItemImage(uploadFormData);\n\n        if (uploadResult.success && uploadResult.imageUrl) {\n          formData.set(\"imageUrl\", uploadResult.imageUrl);\n        } else {\n          setError(uploadResult.error || \"Failed to upload image\");\n          setLoading(false);\n          return;\n        }\n      } else if (initialData?.imageUrl) {\n        formData.set(\"imageUrl\", initialData.imageUrl);\n      }\n\n      let result;\n      if (mode === \"create\") {\n        result = await createItem(formData);\n      } else if (initialData?.id) {\n        result = await updateItem(initialData.id, formData);\n      }\n\n      if (result?.success) {\n        if (onSuccess) {\n          onSuccess();\n        } else {\n          router.push(\"/dashboard\");\n          router.refresh();\n        }\n      } else {\n        setError(result?.error || \"An error occurred\");\n      }\n    } catch {\n      setError(\"An unexpected error occurred\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-6\">\n      {error && <div className=\"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded\">{error}</div>}\n\n      <div>\n        <label htmlFor=\"title\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n          Title *\n        </label>\n        <input type=\"text\" id=\"title\" name=\"title\" required defaultValue={initialData?.title} className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 placeholder:text-gray-500\" placeholder=\"e.g., Black Backpack\" />\n      </div>\n\n      <div>\n        <label htmlFor=\"description\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n          Description *\n        </label>\n        <textarea\n          id=\"description\"\n          name=\"description\"\n          required\n          rows={4}\n          defaultValue={initialData?.description}\n          className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 placeholder:text-gray-500\"\n          placeholder=\"Provide detailed description...\"\n        />\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        <div>\n          <label htmlFor=\"category\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Category *\n          </label>\n          <select id=\"category\" name=\"category\" required defaultValue={initialData?.category} className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900\">\n            <option value=\"\" className=\"text-gray-500\">\n              Select a category\n            </option>\n            {CATEGORIES.map((cat) => (\n              <option key={cat} value={cat}>\n                {cat}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        <div>\n          <label htmlFor=\"status\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n            Status *\n          </label>\n          <select id=\"status\" name=\"status\" required defaultValue={initialData?.status} className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900\">\n            <option value=\"LOST\">Lost</option>\n            <option value=\"FOUND\">Found</option>\n          </select>\n        </div>\n      </div>\n\n      <div>\n        <label htmlFor=\"location\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n          Location *\n        </label>\n        <input type=\"text\" id=\"location\" name=\"location\" required defaultValue={initialData?.location} className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 placeholder:text-gray-500\" placeholder=\"e.g., Library 2nd Floor\" />\n      </div>\n\n      <div>\n        <label htmlFor=\"contactNumber\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n          Contact Number *\n        </label>\n        <input\n          type=\"tel\"\n          id=\"contactNumber\"\n          name=\"contactNumber\"\n          required\n          defaultValue={initialData?.contactNumber}\n          className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 placeholder:text-gray-500\"\n          placeholder=\"e.g., +1234567890\"\n        />\n      </div>\n\n      <div>\n        <label htmlFor=\"image\" className=\"block text-sm font-medium text-gray-700 mb-1\">\n          Image\n        </label>\n        <input\n          type=\"file\"\n          id=\"image\"\n          accept=\"image/*\"\n          onChange={handleImageChange}\n          className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\"\n        />\n        {imagePreview && (\n          <div className=\"mt-3\">\n            <img src={imagePreview} alt=\"Preview\" className=\"w-full max-w-xs h-48 object-cover rounded-md\" />\n          </div>\n        )}\n      </div>\n\n      <div className=\"flex gap-4\">\n        <button type=\"submit\" disabled={loading} className=\"flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\">\n          {loading ? \"Saving...\" : mode === \"create\" ? \"Create Item\" : \"Update Item\"}\n        </button>\n        <button type=\"button\" onClick={() => router.back()} className=\"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50\">\n          Cancel\n        </button>\n      </div>\n    </form>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}