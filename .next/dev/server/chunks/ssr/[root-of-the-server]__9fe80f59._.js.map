{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/sankalpadhungana/Desktop/Sankalpa/lost-and-found/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\nimport { PrismaPg } from \"@prisma/adapter-pg\";\nimport { Pool } from \"pg\";\n\nconst prismaClientSingleton = () => {\n  const pool = new Pool({ connectionString: process.env.DATABASE_URL });\n  const adapter = new PrismaPg(pool);\n  return new PrismaClient({ adapter });\n};\n\ndeclare const globalThis: {\n  prismaGlobal: ReturnType<typeof prismaClientSingleton>;\n} & typeof global;\n\nconst prisma = globalThis.prismaGlobal ?? prismaClientSingleton();\n\nexport default prisma;\n\nif (process.env.NODE_ENV !== \"production\") globalThis.prismaGlobal = prisma;\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;;AAEA,MAAM,wBAAwB;IAC5B,MAAM,OAAO,IAAI,4GAAI,CAAC;QAAE,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAAC;IACnE,MAAM,UAAU,IAAI,uKAAQ,CAAC;IAC7B,OAAO,IAAI,6IAAY,CAAC;QAAE;IAAQ;AACpC;AAMA,MAAM,SAAS,WAAW,YAAY,IAAI;uCAE3B;AAEf,wCAA2C,WAAW,YAAY,GAAG"}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["file:///Users/sankalpadhungana/Desktop/Sankalpa/lost-and-found/lib/auth.ts"],"sourcesContent":["import { cookies } from \"next/headers\";\nimport prisma from \"@/lib/prisma\";\nimport bcrypt from \"bcryptjs\";\nimport { randomBytes } from \"crypto\";\n\nexport async function hashPassword(password: string): Promise<string> {\n  return bcrypt.hash(password, 10);\n}\n\nexport async function verifyPassword(password: string, hashedPassword: string): Promise<boolean> {\n  return bcrypt.compare(password, hashedPassword);\n}\n\nexport async function createSession(userId: string): Promise<string> {\n  const token = randomBytes(32).toString(\"hex\");\n  const expiresAt = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000); // 7 days\n\n  await prisma.session.create({\n    data: {\n      userId,\n      token,\n      expiresAt,\n    },\n  });\n\n  return token;\n}\n\nexport async function getSessionUser(token: string) {\n  const session = await prisma.session.findUnique({\n    where: { token },\n    include: { user: true },\n  });\n\n  if (!session || session.expiresAt < new Date()) {\n    return null;\n  }\n\n  return session.user;\n}\n\nexport async function getCurrentUser() {\n  const cookieStore = await cookies();\n  const token = cookieStore.get(\"session\")?.value;\n\n  if (!token) return null;\n\n  return getSessionUser(token);\n}\n\nexport async function requireAuth() {\n  const user = await getCurrentUser();\n  if (!user) {\n    throw new Error(\"Unauthorized\");\n  }\n  return user;\n}\n\nexport async function requireAdmin() {\n  const user = await requireAuth();\n  if (user.role !== \"ADMIN\") {\n    throw new Error(\"Forbidden: Admin access required\");\n  }\n  return user;\n}\n\nexport async function deleteSession(token: string) {\n  await prisma.session.deleteMany({\n    where: { token },\n  });\n}\n\nexport async function setSessionCookie(token: string) {\n  const cookieStore = await cookies();\n  cookieStore.set(\"session\", token, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === \"production\",\n    sameSite: \"lax\",\n    maxAge: 7 * 24 * 60 * 60, // 7 days\n    path: \"/\",\n  });\n}\n\nexport async function clearSessionCookie() {\n  const cookieStore = await cookies();\n  cookieStore.delete(\"session\");\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;;;;;;;;;AAEO,eAAe,aAAa,QAAgB;IACjD,OAAO,4IAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,eAAe,QAAgB,EAAE,cAAsB;IAC3E,OAAO,4IAAM,CAAC,OAAO,CAAC,UAAU;AAClC;AAEO,eAAe,cAAc,MAAc;IAChD,MAAM,QAAQ,IAAA,oHAAW,EAAC,IAAI,QAAQ,CAAC;IACvC,MAAM,YAAY,IAAI,KAAK,KAAK,GAAG,KAAK,IAAI,KAAK,KAAK,KAAK,OAAO,SAAS;IAE3E,MAAM,wHAAM,CAAC,OAAO,CAAC,MAAM,CAAC;QAC1B,MAAM;YACJ;YACA;YACA;QACF;IACF;IAEA,OAAO;AACT;AAEO,eAAe,eAAe,KAAa;IAChD,MAAM,UAAU,MAAM,wHAAM,CAAC,OAAO,CAAC,UAAU,CAAC;QAC9C,OAAO;YAAE;QAAM;QACf,SAAS;YAAE,MAAM;QAAK;IACxB;IAEA,IAAI,CAAC,WAAW,QAAQ,SAAS,GAAG,IAAI,QAAQ;QAC9C,OAAO;IACT;IAEA,OAAO,QAAQ,IAAI;AACrB;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,0IAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,YAAY;IAE1C,IAAI,CAAC,OAAO,OAAO;IAEnB,OAAO,eAAe;AACxB;AAEO,eAAe;IACpB,MAAM,OAAO,MAAM;IACnB,IAAI,CAAC,MAAM;QACT,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,OAAO,MAAM;IACnB,IAAI,KAAK,IAAI,KAAK,SAAS;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;AAEO,eAAe,cAAc,KAAa;IAC/C,MAAM,wHAAM,CAAC,OAAO,CAAC,UAAU,CAAC;QAC9B,OAAO;YAAE;QAAM;IACjB;AACF;AAEO,eAAe,iBAAiB,KAAa;IAClD,MAAM,cAAc,MAAM,IAAA,0IAAO;IACjC,YAAY,GAAG,CAAC,WAAW,OAAO;QAChC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,QAAQ,IAAI,KAAK,KAAK;QACtB,MAAM;IACR;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,0IAAO;IACjC,YAAY,MAAM,CAAC;AACrB"}},
    {"offset": {"line": 180, "column": 0}, "map": {"version":3,"sources":["file:///Users/sankalpadhungana/Desktop/Sankalpa/lost-and-found/lib/storage.ts"],"sourcesContent":["import { writeFile, unlink } from \"fs/promises\";\nimport { join } from \"path\";\n\nexport async function uploadImage(file: File): Promise<string> {\n  // Generate unique filename\n  const fileExt = file.name.split(\".\").pop();\n  const fileName = `${Math.random().toString(36).substring(2)}-${Date.now()}.${fileExt}`;\n\n  // Convert File to Buffer\n  const bytes = await file.arrayBuffer();\n  const buffer = Buffer.from(bytes);\n\n  // Save to public/uploads directory\n  const uploadsDir = join(process.cwd(), \"public\", \"uploads\");\n  const filePath = join(uploadsDir, fileName);\n\n  await writeFile(filePath, buffer);\n\n  // Return relative URL\n  return `/uploads/${fileName}`;\n}\n\nexport async function deleteImage(imageUrl: string): Promise<void> {\n  try {\n    // Extract filename from URL\n    const fileName = imageUrl.split(\"/\").pop();\n    if (!fileName) return;\n\n    // Delete from public/uploads directory\n    const filePath = join(process.cwd(), \"public\", \"uploads\", fileName);\n    await unlink(filePath);\n  } catch (error) {\n    console.error(\"Failed to delete image:\", error);\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,eAAe,YAAY,IAAU;IAC1C,2BAA2B;IAC3B,MAAM,UAAU,KAAK,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG;IACxC,MAAM,WAAW,GAAG,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,SAAS,CAAC,GAAG,CAAC,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,SAAS;IAEtF,yBAAyB;IACzB,MAAM,QAAQ,MAAM,KAAK,WAAW;IACpC,MAAM,SAAS,OAAO,IAAI,CAAC;IAE3B,mCAAmC;IACnC,MAAM,aAAa,IAAA,yGAAI,EAAC,QAAQ,GAAG,IAAI,UAAU;IACjD,MAAM,WAAW,IAAA,yGAAI,EAAC,YAAY;IAElC,MAAM,IAAA,kIAAS,EAAC,UAAU;IAE1B,sBAAsB;IACtB,OAAO,CAAC,SAAS,EAAE,UAAU;AAC/B;AAEO,eAAe,YAAY,QAAgB;IAChD,IAAI;QACF,4BAA4B;QAC5B,MAAM,WAAW,SAAS,KAAK,CAAC,KAAK,GAAG;QACxC,IAAI,CAAC,UAAU;QAEf,uCAAuC;QACvC,MAAM,WAAW,IAAA,yGAAI,EAAC,QAAQ,GAAG,IAAI,UAAU,WAAW;QAC1D,MAAM,IAAA,+HAAM,EAAC;IACf,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;IAC3C;AACF"}},
    {"offset": {"line": 222, "column": 0}, "map": {"version":3,"sources":["file:///Users/sankalpadhungana/Desktop/Sankalpa/lost-and-found/app/actions/items.ts"],"sourcesContent":["\"use server\";\n\nimport prisma from \"@/lib/prisma\";\nimport { requireAuth } from \"@/lib/auth\";\nimport { revalidatePath } from \"next/cache\";\nimport { Category, ItemStatus } from \"@prisma/client\";\nimport { uploadImage, deleteImage } from \"@/lib/storage\";\n\nexport async function uploadItemImage(formData: FormData) {\n  try {\n    const file = formData.get(\"file\") as File;\n    if (!file) {\n      return { success: false, error: \"No file provided\" };\n    }\n\n    const imageUrl = await uploadImage(file);\n    return { success: true, imageUrl };\n  } catch (error) {\n    console.error(\"Error uploading image:\", error);\n    return { success: false, error: \"Failed to upload image\" };\n  }\n}\n\nexport async function createItem(formData: FormData) {\n  const user = await requireAuth();\n\n  const title = formData.get(\"title\") as string;\n  const description = formData.get(\"description\") as string;\n  const category = formData.get(\"category\") as Category;\n  const location = formData.get(\"location\") as string;\n  const contactNumber = formData.get(\"contactNumber\") as string;\n  const status = formData.get(\"status\") as ItemStatus;\n  const imageUrl = formData.get(\"imageUrl\") as string;\n\n  try {\n    const item = await prisma.item.create({\n      data: {\n        title,\n        description,\n        category,\n        location,\n        contactNumber,\n        status,\n        imageUrl,\n        userId: user.id,\n      },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    return { success: true, item };\n  } catch (error) {\n    console.error(\"Error creating item:\", error);\n    return { success: false, error: \"Failed to create item\" };\n  }\n}\n\nexport async function updateItem(itemId: string, formData: FormData) {\n  const user = await requireAuth();\n\n  const item = await prisma.item.findUnique({\n    where: { id: itemId },\n  });\n\n  if (!item) {\n    return { success: false, error: \"Item not found\" };\n  }\n\n  // Check if user owns the item or is admin\n  if (item.userId !== user.id && user.role !== \"ADMIN\") {\n    return { success: false, error: \"Unauthorized\" };\n  }\n\n  const title = formData.get(\"title\") as string;\n  const description = formData.get(\"description\") as string;\n  const category = formData.get(\"category\") as Category;\n  const location = formData.get(\"location\") as string;\n  const contactNumber = formData.get(\"contactNumber\") as string;\n  const status = formData.get(\"status\") as ItemStatus;\n  const imageUrl = formData.get(\"imageUrl\") as string | null;\n\n  try {\n    const updatedItem = await prisma.item.update({\n      where: { id: itemId },\n      data: {\n        title,\n        description,\n        category,\n        location,\n        contactNumber,\n        status,\n        ...(imageUrl && { imageUrl }),\n      },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    revalidatePath(`/items/${itemId}`);\n    return { success: true, item: updatedItem };\n  } catch (error) {\n    console.error(\"Error updating item:\", error);\n    return { success: false, error: \"Failed to update item\" };\n  }\n}\n\nexport async function deleteItem(itemId: string) {\n  const user = await requireAuth();\n\n  const item = await prisma.item.findUnique({\n    where: { id: itemId },\n  });\n\n  if (!item) {\n    return { success: false, error: \"Item not found\" };\n  }\n\n  // Check if user owns the item or is admin\n  if (item.userId !== user.id && user.role !== \"ADMIN\") {\n    return { success: false, error: \"Unauthorized\" };\n  }\n\n  try {\n    // Delete image if exists\n    if (item.imageUrl) {\n      await deleteImage(item.imageUrl);\n    }\n\n    await prisma.item.delete({\n      where: { id: itemId },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    return { success: true };\n  } catch (error) {\n    console.error(\"Error deleting item:\", error);\n    return { success: false, error: \"Failed to delete item\" };\n  }\n}\n\nexport async function markItemAsResolved(itemId: string, resolved: boolean) {\n  const user = await requireAuth();\n\n  const item = await prisma.item.findUnique({\n    where: { id: itemId },\n  });\n\n  if (!item) {\n    return { success: false, error: \"Item not found\" };\n  }\n\n  // Check if user owns the item or is admin\n  if (item.userId !== user.id && user.role !== \"ADMIN\") {\n    return { success: false, error: \"Unauthorized\" };\n  }\n\n  try {\n    const updatedItem = await prisma.item.update({\n      where: { id: itemId },\n      data: { isResolved: resolved },\n    });\n\n    revalidatePath(\"/\");\n    revalidatePath(\"/dashboard\");\n    revalidatePath(`/items/${itemId}`);\n    return { success: true, item: updatedItem };\n  } catch (error) {\n    console.error(\"Error updating item:\", error);\n    return { success: false, error: \"Failed to update item\" };\n  }\n}\n\nexport async function getItems(filters?: { search?: string; category?: Category; status?: ItemStatus; resolved?: boolean }) {\n  try {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const where: any = {};\n\n    if (filters?.search) {\n      where.OR = [{ title: { contains: filters.search, mode: \"insensitive\" } }, { description: { contains: filters.search, mode: \"insensitive\" } }, { location: { contains: filters.search, mode: \"insensitive\" } }];\n    }\n\n    if (filters?.category) {\n      where.category = filters.category;\n    }\n\n    if (filters?.status) {\n      where.status = filters.status;\n    }\n\n    if (filters?.resolved !== undefined) {\n      where.isResolved = filters.resolved;\n    }\n\n    const items = await prisma.item.findMany({\n      where,\n      include: {\n        user: {\n          select: {\n            name: true,\n            email: true,\n          },\n        },\n      },\n      orderBy: {\n        createdAt: \"desc\",\n      },\n    });\n\n    return items;\n  } catch (error) {\n    console.error(\"Error fetching items:\", error);\n    return [];\n  }\n}\n\nexport async function getItemById(itemId: string) {\n  try {\n    const item = await prisma.item.findUnique({\n      where: { id: itemId },\n      include: {\n        user: {\n          select: {\n            name: true,\n            email: true,\n          },\n        },\n      },\n    });\n\n    return item;\n  } catch (error) {\n    console.error(\"Error fetching item:\", error);\n    return null;\n  }\n}\n\nexport async function getUserItems() {\n  const user = await requireAuth();\n\n  try {\n    const items = await prisma.item.findMany({\n      where: { userId: user.id },\n      orderBy: { createdAt: \"desc\" },\n    });\n\n    return items;\n  } catch (error) {\n    console.error(\"Error fetching user items:\", error);\n    return [];\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 579, "column": 0}, "map": {"version":3,"sources":["file:///Users/sankalpadhungana/Desktop/Sankalpa/lost-and-found/app/actions/auth.ts"],"sourcesContent":["\"use server\";\n\nimport prisma from \"@/lib/prisma\";\nimport { hashPassword, verifyPassword, createSession, setSessionCookie, clearSessionCookie, deleteSession } from \"@/lib/auth\";\nimport { revalidatePath } from \"next/cache\";\nimport { redirect } from \"next/navigation\";\nimport { cookies } from \"next/headers\";\n\nexport async function signUp(email: string, password: string, name?: string) {\n  try {\n    // Check if user already exists\n    const existing = await prisma.user.findUnique({ where: { email } });\n    if (existing) {\n      return { success: false, error: \"Email already in use\" };\n    }\n\n    // Hash password and create user\n    const hashedPassword = await hashPassword(password);\n    const user = await prisma.user.create({\n      data: {\n        email,\n        password: hashedPassword,\n        name,\n        role: \"STUDENT\",\n      },\n    });\n\n    // Create session\n    const token = await createSession(user.id);\n    await setSessionCookie(token);\n\n    return { success: true, user: { id: user.id, email: user.email, name: user.name } };\n  } catch (error) {\n    console.error(\"Signup error:\", error);\n    return { success: false, error: \"Failed to create account\" };\n  }\n}\n\nexport async function signIn(email: string, password: string) {\n  try {\n    // Find user\n    const user = await prisma.user.findUnique({ where: { email } });\n    if (!user) {\n      return { success: false, error: \"Invalid email or password\" };\n    }\n\n    // Verify password\n    const valid = await verifyPassword(password, user.password);\n    if (!valid) {\n      return { success: false, error: \"Invalid email or password\" };\n    }\n\n    // Create session\n    const token = await createSession(user.id);\n    await setSessionCookie(token);\n\n    return { success: true, user: { id: user.id, email: user.email, name: user.name } };\n  } catch (error) {\n    console.error(\"Signin error:\", error);\n    return { success: false, error: \"Failed to sign in\" };\n  }\n}\n\nexport async function signOut() {\n  try {\n    const cookieStore = await cookies();\n    const token = cookieStore.get(\"session\")?.value;\n\n    if (token) {\n      await deleteSession(token);\n    }\n\n    await clearSessionCookie();\n    revalidatePath(\"/\");\n  } catch (error) {\n    console.error(\"Signout error:\", error);\n  }\n\n  redirect(\"/login\");\n}\n"],"names":[],"mappings":";;;;;;;;;AAEA;AACA;AACA;AACA;AAAA;AACA;;;;;;;;;;;;;AAEO,eAAe,OAAO,KAAa,EAAE,QAAgB,EAAE,IAAa;IACzE,IAAI;QACF,+BAA+B;QAC/B,MAAM,WAAW,MAAM,wHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YAAE,OAAO;gBAAE;YAAM;QAAE;QACjE,IAAI,UAAU;YACZ,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAuB;QACzD;QAEA,gCAAgC;QAChC,MAAM,iBAAiB,MAAM,IAAA,2HAAY,EAAC;QAC1C,MAAM,OAAO,MAAM,wHAAM,CAAC,IAAI,CAAC,MAAM,CAAC;YACpC,MAAM;gBACJ;gBACA,UAAU;gBACV;gBACA,MAAM;YACR;QACF;QAEA,iBAAiB;QACjB,MAAM,QAAQ,MAAM,IAAA,4HAAa,EAAC,KAAK,EAAE;QACzC,MAAM,IAAA,+HAAgB,EAAC;QAEvB,OAAO;YAAE,SAAS;YAAM,MAAM;gBAAE,IAAI,KAAK,EAAE;gBAAE,OAAO,KAAK,KAAK;gBAAE,MAAM,KAAK,IAAI;YAAC;QAAE;IACpF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,OAAO;YAAE,SAAS;YAAO,OAAO;QAA2B;IAC7D;AACF;AAEO,eAAe,OAAO,KAAa,EAAE,QAAgB;IAC1D,IAAI;QACF,YAAY;QACZ,MAAM,OAAO,MAAM,wHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YAAE,OAAO;gBAAE;YAAM;QAAE;QAC7D,IAAI,CAAC,MAAM;YACT,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAA4B;QAC9D;QAEA,kBAAkB;QAClB,MAAM,QAAQ,MAAM,IAAA,6HAAc,EAAC,UAAU,KAAK,QAAQ;QAC1D,IAAI,CAAC,OAAO;YACV,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAA4B;QAC9D;QAEA,iBAAiB;QACjB,MAAM,QAAQ,MAAM,IAAA,4HAAa,EAAC,KAAK,EAAE;QACzC,MAAM,IAAA,+HAAgB,EAAC;QAEvB,OAAO;YAAE,SAAS;YAAM,MAAM;gBAAE,IAAI,KAAK,EAAE;gBAAE,OAAO,KAAK,KAAK;gBAAE,MAAM,KAAK,IAAI;YAAC;QAAE;IACpF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,OAAO;YAAE,SAAS;YAAO,OAAO;QAAoB;IACtD;AACF;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,cAAc,MAAM,IAAA,0IAAO;QACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,YAAY;QAE1C,IAAI,OAAO;YACT,MAAM,IAAA,4HAAa,EAAC;QACtB;QAEA,MAAM,IAAA,iIAAkB;QACxB,IAAA,+IAAc,EAAC;IACjB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kBAAkB;IAClC;IAEA,IAAA,iMAAQ,EAAC;AACX;;;IAvEsB;IA8BA;IAyBA;;AAvDA,+OAAA;AA8BA,+OAAA;AAyBA,+OAAA"}},
    {"offset": {"line": 720, "column": 0}, "map": {"version":3,"sources":["file:///Users/sankalpadhungana/Desktop/Sankalpa/lost-and-found/.next-internal/server/app/dashboard/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {getUserItems as '00312d9fe6b4eec4b2b4f95c98ac2726a8e1629991'} from 'ACTIONS_MODULE0'\nexport {uploadItemImage as '4037b900e8ea0f369d58d10de333a0433a9fcf99f6'} from 'ACTIONS_MODULE0'\nexport {createItem as '4086ff0012400720f23d57b422edfc396b7c4e91d9'} from 'ACTIONS_MODULE0'\nexport {deleteItem as '409ec236e3d43a6f76874410f5949f4d962fd5931f'} from 'ACTIONS_MODULE0'\nexport {getItemById as '40a1f0ece06357f891e26744741b085c6010a8282a'} from 'ACTIONS_MODULE0'\nexport {getItems as '40c769ba508e79cb775f59f6a5813e7f61a1bbcd21'} from 'ACTIONS_MODULE0'\nexport {updateItem as '6044c470283a97afcba77b88b694649ba0520d9162'} from 'ACTIONS_MODULE0'\nexport {markItemAsResolved as '60cc06e6093b100d49456c0972f6d86ee92c4f3edb'} from 'ACTIONS_MODULE0'\nexport {signOut as '008e45fc972c3945641e954c70da7926adcbf62a37'} from 'ACTIONS_MODULE1'\n"],"names":[],"mappings":";AAAA;AAQA"}}]
}